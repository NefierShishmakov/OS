Что такое семафоры?

Семафоры это один из первых примитивов синхронизации, представляет он из себя
счётчик, для которого определены две основные операции sem_post() и sem_wait()
Т.е. одна из них увеличивает счётчик на единицу, другая уменьшает счётчки на единицу.
При достижении нуля, тот поток, который пытается уменьшить счётчик, т.е. сделает sem_wait(), приведёт к тому, что этот 
поток заблокируется, до тех пор, пока кто-то не сделает sem_post(), чтобы этот счётчик не увеличить.

Операции sem_post() и sem_wait() - они атомарны, т.е. они либо произойдут, либо не произойдут.

У нас есть неименованные семафоры, они создаются и уничтожаются при помощи sem_init() и sem_destroy() соответственно.
Как мы можем ими пользоваться? 
Внутри процесса их создавать и шарить их между потоками процесса.

Есть семафоры именованные:
Создаются при помощи sem_open()
Закрываются при помощи sem_close(),
Разрушаются при помощи sem_unlink()



Когда мы говорим про мьютекс, у мьютекс обязательно есть владелец(поток, который его захватил, должен его разблокировать)
У семафора владельца нет, он не привязан ни к потоку, ни к процессу.

Т.е. возможна такая схема работы с семафорами, что один поток лочит семафор, а другой его анлочит.

Также мы можем использовать наш семафор как мьютекс:
sem_init(sem, 0, 1);


// Такой код будет написан во всех потоках
sem_wait(&sem)
//critical section
sem_post(&sem);
